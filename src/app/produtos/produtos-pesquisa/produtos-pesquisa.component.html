<div class="container">
   <div class="ui-g">
      <form autocomplete="off" (ngSubmit)="pesquisar()">
         <div class="ui-g-12">
            <h1>Produtos</h1>
         </div>

         <div class="ui-g-12 ui-fluid">
            <label>Nome</label>
            <input
               pInputText
               type="text"
               name="nome"
               [(ngModel)]="filtro.nome"
            />
         </div>

         <div class="ui-g-12">
            <button pButton type="submit" label="Pesquisar"></button>
         </div>
      </form>
   </div>

   <div class="ui-g">
      <div class="ui-g-12">
         <p-table
            [value]="produtos"
            [paginator]="true"
            [rows]="filtro.itensPorPagina"
            [responsive]="true"
            [lazy]="true"
            [totalRecords]="totalRegistros"
            (onLazyLoad)="aoMudarPagina($event)"
            #tabela
         >
            <ng-template pTemplate="emptymessage">
               <strong>Nenhum Produto Encontrado</strong>
            </ng-template>

            <ng-template pTemplate="header">
               <tr>
                  <th class="col-data-header">Nome</th>
                  <th class="col-valor-header">Valor</th>
                  <th class="col-data-header">Situação</th>
                  <th>Categoria</th>
                  <th>Unidade</th>
                  <th class="col-valor-header"></th>
               </tr>
            </ng-template>

            <ng-template pTemplate="body" let-produto>
               <tr>
                  <td>
                     <span class="ui-column-title">Descrição</span>
                     {{ produto.nome }}
                  </td>
                  <td class="col-valor-content">
                     <span class="ui-column-title">Valor</span>
                     {{ produto.valorUnitario | currency: "BRL":true:"1.2-2" }}
                  </td>
                  <td class="col-data-content">
                     <span class="ui-column-title">Tipo</span>
                     {{ produto.situacao }}
                  </td>
                  <td>
                     <span class="ui-column-title">Categoria</span>
                     {{ produto.categoria.descricao }}
                  </td>
                  <td>
                     <span class="ui-column-title">Unidade</span>
                     {{ produto.unidade?.descricao }}
                  </td>
                  <td class="col-acoes">
                     <button
                        class="espaco-icones"
                        pButton
                        icon="pi pi-pencil"
                        pTooltip="Editar"
                        [routerLink]="['/produtos', produto.id]"
                        tooltipPosition="top"
                     ></button>
                     <button
                        class="espaco-icones"
                        pButton
                        icon="pi pi-trash"
                        pTooltip="Excluir"
                        tooltipPosition="top"
                        (click)="confirmarExclusao(produto)"
                        [disabled]="!auth.temPermissao('ROLE_REMOVER_PRODUTO')"
                     ></button>
                     <!-- esconder botão
                        *nfIg="auth.temPermissao('ROLE_REMOVER_LANCAMENTO')"
                        não nega o auth -->
                  </td>
               </tr>
            </ng-template>
         </p-table>
      </div>

      <div class="ui-g-12">
         <button
            pButton
            label="Novo Produto"
            routerLink="/produtos/novo"
         ></button>
      </div>
   </div>
</div>
